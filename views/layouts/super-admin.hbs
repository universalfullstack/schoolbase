<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Primary Meta Tags -->
  <title>{{title}} &mdash; {{#if settings.general.systemName}}{{settings.general.systemName}}{{else}}My School System{{/if}} Super Admin</title>
  <meta name="description" content="{{#if settings.general.description}}{{settings.general.description}}{{else}}Manage your school efficiently with our school management system.{{/if}}">
  <meta name="author" content="School Admin">
  <meta name="keywords" content="school, management, students, staff, administration, {{#if settings.general.abbreviation}}{{settings.general.abbreviation}}{{/if}}">

  <!-- Open Graph / Facebook -->
  <meta property="og:title" content="{{#if settings.general.systemName}}{{settings.general.systemName}}{{else}}My School System{{/if}}">
  <meta property="og:description" content="{{#if settings.general.description}}{{settings.general.description}}{{else}}Manage your school efficiently with our school management system.{{/if}}">
  <meta property="og:image" content="{{#if settings.branding.logo}}{{settings.branding.logo}}{{else}}/images/default-logo.png{{/if}}">
  <meta property="og:type" content="website">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{#if settings.general.systemName}}{{settings.general.systemName}}{{else}}My School System{{/if}}">
  <meta name="twitter:description" content="{{#if settings.general.description}}{{settings.general.description}}{{else}}Manage your school efficiently with our school management system.{{/if}}">
  <meta name="twitter:image" content="{{#if settings.branding.logo}}{{settings.branding.logo}}{{else}}/images/default-logo.png{{/if}}">

  <!-- Favicon -->
  <link rel="icon" href="{{#if settings.branding.favicon}}{{settings.branding.favicon}}{{else}}/images/default-favicon.png{{/if}}" type="image/png">
  
  <!-- Bootstrap 5 CSS -->
  <link href="/css/style.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body { min-height: 100vh; }

    .layout {
      display: grid;
      grid-template-columns: 220px 1fr;
      min-height: 100vh;
    }

    .sidebar {
      width: 220px;
      background: #fff;
      border-right: 1px solid #dee2e6;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    main.content {
      padding: 1.5rem;
      background: #f8f9fa;
      overflow-x: hidden;
    }

    .user-img { width: 40px; height: 40px; object-fit: cover; border-radius: 50%; }
    .nav-link i { font-size: 1.1rem; }

    @media (max-width: 991.98px) {
      .layout { grid-template-columns: 1fr; }
      .sidebar { display: none; }
    }
  </style>
      
  <!-- Page-specific styles -->
  {{{_sections.styles}}}
</head>

<body class="bg-light">

<header class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
  <div class="container-fluid d-flex justify-content-between align-items-center">
    <!-- Mobile sidebar toggle -->
    <div class="d-flex align-items-center">
      <button class="btn btn-outline-primary d-lg-none me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
        <i class="bi bi-list"></i>
      </button>

      <a href="/" class="navbar-brand d-flex align-items-center text-dark">
        <img src="{{#if settings.branding.logo}}{{settings.branding.logo}}{{else}}/images/default-logo.png{{/if}}" alt="logo" class="rounded me-2" style="width:36px;height:36px;object-fit:cover;">
        <span class="fw-bold">{{#if settings.general.systemName}}{{settings.general.systemName}}{{else}}My School System{{/if}}</span>
      </a>
    </div>

    <!-- Topbar right side -->
    <div class="d-flex align-items-center gap-3">
      <!-- Notifications -->
      <div class="dropdown">
        <button class="btn btn-outline-secondary position-relative" type="button" data-bs-toggle="dropdown">
          <i class="bi bi-bell"></i>
          {{#if notificationsCount}}
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
            {{notificationsCount}}
          </span>
          {{/if}}
        </button>
        <ul class="dropdown-menu dropdown-menu-end" style="min-width:300px;">
          <li class="dropdown-header">Notifications</li>
          {{#each notifications}}
            <li><a class="dropdown-item" href="{{this.link}}">{{this.text}} <small class="text-muted d-block">{{this.when}}</small></a></li>
          {{else}}
            <li class="dropdown-item text-muted">No notifications</li>
          {{/each}}
        </ul>
      </div>

      <!-- User menu -->
      <div class="dropdown">
        <a class="d-flex align-items-center text-decoration-none dropdown-toggle" href="#" data-bs-toggle="dropdown">
          <img src="{{#if user.profileImage}}{{user.profileImage}}{{else}}/images/user-default.png{{/if}}" alt="user" class="user-img me-2">
          <span class="d-none d-md-inline">{{user.firstName}} {{user.lastName}}</span>
        </a>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="/super-admin/profile"><i class="bi bi-person-circle me-2"></i>Profile</a></li>
          <li><a class="dropdown-item" href="/super-admin/settings"><i class="bi bi-gear me-2"></i>Settings</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item text-danger" href="/logout"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
        </ul>
      </div>
    </div>
  </div>
</header>

<div class="layout">
  <!-- Desktop Sidebar -->
  <nav class="sidebar d-none d-lg-flex flex-column p-3">
    <div class="d-flex align-items-center mb-4">
      <img src="{{user.profileImage}}" alt="admin" class="user-img me-2">
      <div>
        <div>{{user.firstName}} {{user.lastName}}</div>
        <small class="text-muted">{{user.role}}</small>
      </div>
    </div>

    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item mb-1">
        <a class="nav-link {{#ifActive '/super-admin/dashboard'}}active{{/ifActive}}" href="/super-admin/dashboard">
          <i class="bi bi-speedometer2 me-2"></i>Dashboard
        </a>
      </li>

      <!-- Schools -->
      <li class="nav-item mb-1">
        <a class="nav-link d-flex justify-content-between align-items-center {{#ifActivePrefix currentPath '/super-admin/schools'}}{{else}}collapsed{{/ifActivePrefix}}" data-bs-toggle="collapse" href="#schoolsMenu" aria-expanded="{{#ifActivePrefix currentPath '/super-admin/schools'}}true{{else}}false{{/ifActivePrefix}}">
          <span><i class="bi bi-mortarboard me-2"></i>Schools</span>
          <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse ps-3 {{#ifActivePrefix currentPath '/super-admin/schools'}}show{{/ifActivePrefix}}" id="schoolsMenu">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link {{#ifActive '/super-admin/schools'}}active{{/ifActive}}" href="/super-admin/schools">All Schools</a></li>
            <li class="nav-item"><a class="nav-link {{#ifActive '/super-admin/schools/create/new'}}active{{/ifActive}}" href="/super-admin/schools/create/new">Create School</a></li>
          </ul>
        </div>
      </li>

      <!-- Students -->
      <li class="nav-item mb-1">
        <a class="nav-link d-flex justify-content-between align-items-center {{#ifActivePrefix currentPath '/super-admin/students'}}{{else}}collapsed{{/ifActivePrefix}}" data-bs-toggle="collapse" href="#studentsMenu" aria-expanded="{{#ifActivePrefix currentPath '/super-admin/students'}}true{{else}}false{{/ifActivePrefix}}">
          <span><i class="bi bi-people me-2"></i>Students</span>
          <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse ps-3 {{#ifActivePrefix currentPath '/super-admin/students'}}show{{/ifActivePrefix}}" id="studentsMenu">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link {{#ifActive '/super-admin/students'}}active{{/ifActive}}" href="/super-admin/students">All Students</a></li>
            <li class="nav-item"><a class="nav-link {{#ifActive '/super-admin/enrollments'}}active{{/ifActive}}" href="/super-admin/enrollments">Enrollments</a></li>
          </ul>
        </div>
      </li>

      <!-- Staff -->
      <li class="nav-item mb-1">
        <a class="nav-link d-flex justify-content-between align-items-center {{#ifActivePrefix currentPath '/super-admin/staff'}}{{else}}collapsed{{/ifActivePrefix}}" data-bs-toggle="collapse" href="#staffMenu" aria-expanded="{{#ifActivePrefix currentPath '/super-admin/staff'}}true{{else}}false{{/ifActivePrefix}}">
          <span><i class="bi bi-person-badge me-2"></i>Staff</span>
          <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse ps-3 {{#ifActivePrefix currentPath '/super-admin/staff'}}show{{/ifActivePrefix}}" id="staffMenu">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link {{#ifActive '/super-admin/staff'}}active{{/ifActive}}" href="/super-admin/staff">All Staff</a></li>
            <li class="nav-item"><a class="nav-link {{#ifActive '/super-admin/roles'}}active{{/ifActive}}" href="/super-admin/roles">Roles</a></li>
          </ul>
        </div>
      </li>

      <li class="nav-item mb-1">
        <a class="nav-link {{#ifActive '/super-admin/classes'}}active{{/ifActive}}" href="/super-admin/classes">
          <i class="bi bi-journal-bookmark me-2"></i>Classes
        </a>
      </li>

      <li class="nav-item mt-3"><small class="text-muted px-2">Administration</small></li>
      <li class="nav-item mb-1"><a class="nav-link {{#ifActive '/super-admin/schools'}}active{{/ifActive}}" href="/super-admin/schools"><i class="bi bi-building me-2"></i>School details</a></li>
      <li class="nav-item mb-1"><a class="nav-link {{#ifActive '/super-admin/settings'}}active{{/ifActive}}" href="/super-admin/settings"><i class="bi bi-gear me-2"></i>Settings</a></li>
    </ul>

    <div class="mt-auto text-muted small">
      <div>&copy; {{year}} {{school.name}}</div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="content">
    {{{body}}}
  </main>
</div>

<!-- Mobile Offcanvas Sidebar -->
<div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="mobileSidebar">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title">{{school.name}}</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body p-0">
    <nav class="nav flex-column">
      <a class="nav-link {{#ifActive '/super-admin/dashboard'}}active{{/ifActive}}" href="/super-admin/dashboard"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a>
      <a class="nav-link {{#ifActive '/super-admin/schools'}}active{{/ifActive}}" href="/super-admin/schools"><i class="bi bi-building me-2"></i>Schools</a>
      <a class="nav-link {{#ifActive '/super-admin/students'}}active{{/ifActive}}" href="/super-admin/students"><i class="bi bi-people me-2"></i>Students</a>
      <a class="nav-link {{#ifActive '/super-admin/staff'}}active{{/ifActive}}" href="/super-admin/staff"><i class="bi bi-person-badge me-2"></i>Staff</a>
      <a class="nav-link {{#ifActive '/super-admin/classes'}}active{{/ifActive}}" href="/super-admin/classes"><i class="bi bi-journal-bookmark me-2"></i>Classes</a>
      <a class="nav-link {{#ifActive '/super-admin/settings'}}active{{/ifActive}}" href="/super-admin/settings"><i class="bi bi-gear me-2"></i>Settings</a>
    </nav>
  </div>
</div>

<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<!-- Page-specific scripts -->
{{{_sections.scripts}}}
</body>
</html>
